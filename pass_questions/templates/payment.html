{% extends "base.html" %}
{% block title %}Payment - PassQuestion{% endblock %}

{% block content %}
<section class="min-h-screen flex flex-col items-center justify-center bg-gray-50 text-center px-6 pt-32 pb-20">
  <div class="w-full max-w-md bg-white p-8 rounded-xl shadow-lg">
    <h2 class="text-2xl font-bold mb-4">Hello <span id="username">{{ user.username or 'User' }}</span>!</h2>
    <p class="mb-6">Please pay <strong>50 Cedis</strong> to access your dashboard.</p>

    <button id="payBtn" type="button"
      class="w-full py-3 bg-green-600 hover:bg-green-700 text-white font-semibold rounded-xl shadow-lg transition">
      Pay 50 Cedis
    </button>
  </div>
</section>

<script>
document.getElementById("payBtn").addEventListener("click", () => {
    // 1️⃣ Mark user as paid in session (Flask will handle DB)
    fetch("/payment/mock", { method: "POST" })
        .then(res => res.json())
        .then(data => {
            if (data.status === "success") {
                // 2️⃣ Redirect to success page
                window.location.href = "/payment/success";
            } else {
                alert("Something went wrong. Please try again.");
            }
        })
        .catch(err => {
            console.error(err);
            alert("Payment failed. Check console for details.");
        });
});
</script>
{% endblock %}
